"0","# Annual summaries for joining to yearly analyses (Obj.1 & Obj.2)"
"0","weather_yearly <- WeatherData |>"
"0","  filter(YEAR >= 1992, YEAR <= 2024) |>"
"0","  group_by(YEAR) |>"
"0","  summarise("
"0","    mean_temp  = mean(TEMP, na.rm = TRUE),"
"0","    max_temp   = max(MAX,  na.rm = TRUE),"
"0","    min_temp   = min(MIN,  na.rm = TRUE),"
"0","    total_rain = sum(PRCP, na.rm = TRUE),"
"0","    max_rain   = max(PRCP, na.rm = TRUE),              # wettest day"
"0","    rain_days  = sum(PRCP > 0, na.rm = TRUE),          # count of rainy days"
"0","    mean_wind  = mean(WDSP, na.rm = TRUE),"
"0","    max_wind   = max(MXSPD, na.rm = TRUE),"
"0","    hail_days  = sum(I_HAIL, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Daily table for pre-laying windows (Obj.3)"
"0","weather_df <- WeatherData |>"
"0","  mutate("
"0","    date      = make_date(YEAR, MONTH, DAY),"
"0","    mean_temp = readr::parse_number(as.character(TEMP)),"
"0","    max_temp  = readr::parse_number(as.character(MAX)),"
"0","    min_temp  = readr::parse_number(as.character(MIN)),"
"0","    mean_wind = readr::parse_number(as.character(WDSP)),"
"0","    max_wind  = readr::parse_number(as.character(MXSPD)),"
"0","    rain      = readr::parse_number(as.character(PRCP)),"
"0","    rain_day  = as.integer(replace_na(rain, 0) > 0)"
"0","  ) |>"
"0","  arrange(date)"
"0",""
