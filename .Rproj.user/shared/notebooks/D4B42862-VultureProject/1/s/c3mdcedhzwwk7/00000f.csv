"0","# Plot predicted effect of rainy days (60-day window)"
"0","new_rain60 <- tibble("
"0","  rain_days_60 = seq(min(timing_weather_60$rain_days_60, na.rm = TRUE),"
"0","                     max(timing_weather_60$rain_days_60, na.rm = TRUE), length.out = 100),"
"0","  max_wind_60  = mean(timing_weather_60$max_wind_60, na.rm = TRUE),"
"0","  year         = mean(timing_weather_60$year, na.rm = TRUE)"
"0",")"
"0",""
"0","pred <- predict(timing_weather_60_model, newdata = new_rain60, se.fit = TRUE)"
"0","new_rain60 <- new_rain60 |>"
"0","  mutate(fit = pred$fit, lwr = pred$fit - 1.96*pred$se.fit, upr = pred$fit + 1.96*pred$se.fit)"
"0",""
"0","ggplot() +"
"0","  geom_point(data = timing_weather_60, aes(rain_days_60, lay_DOY), alpha = 0.3, size = 1) +"
"0","  geom_line(data = new_rain60, aes(rain_days_60, fit), colour = ""black"", linewidth = 1) +"
"0","  geom_ribbon(data = new_rain60, aes(rain_days_60, ymin = lwr, ymax = upr), fill = ""grey80"", alpha = 0.4) +"
"0","  labs(title = ""Effect of 60-day pre-laying rainfall on laying date"","
"0","       x = ""Rainy days in the 60 days before laying"", y = ""Predicted laying date (DOY)"")"
"0",""
